{"version":3,"file":"leaflet-elevation.js","sources":["../node_modules/leaflet-i18n/Leaflet.i18n.js","../src/utils.js","../src/components.js","../src/chart.js","../src/marker.js","../src/summary.js","../src/options.js","../src/control.js","../src/slope.js","../src/index.js"],"sourcesContent":["// Following https://github.com/Leaflet/Leaflet/blob/master/PLUGIN-GUIDE.md\n(function (factory, window) {\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n        // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if (typeof window !== 'undefined' && window.L) {\n        factory(window.L);\n\n    }\n}(function (L) {\n    L.locales = {};\n    L.locale = null;\n    L.registerLocale = function registerLocale(code, locale) {\n        L.locales[code] = L.Util.extend({}, L.locales[code], locale);\n    };\n    L.setLocale = function setLocale(code) {\n        L.locale = code;\n    };\n    return L.i18n = L._ = function translate(string, data) {\n        if (L.locale && L.locales[L.locale] && L.locales[L.locale][string]) {\n            string = L.locales[L.locale][string];\n        }\n        try {\n            // Do not fail if some data is missing\n            // a bad translation should not break the app\n            string = L.Util.template(string, data);\n        }\n        catch (err) {/*pass*/\n        }\n\n        return string;\n    };\n}, window));\n","/**\n * Recursive deep merge objects.\n * Alternative to L.Util.setOptions(this, options).\n */\nexport function deepMerge(target, ...sources) {\n\tif (!sources.length) return target;\n\tconst source = sources.shift();\n\tif (isObject(target) && isObject(source)) {\n\t\tfor (const key in source) {\n\t\t\tif (isObject(source[key])) {\n\t\t\t\tif (!target[key]) Object.assign(target, {\n\t\t\t\t\t[key]: {}\n\t\t\t\t});\n\t\t\t\tdeepMerge(target[key], source[key]);\n\t\t\t} else {\n\t\t\t\tObject.assign(target, {\n\t\t\t\t\t[key]: source[key]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\treturn deepMerge(target, ...sources);\n}\n\n/**\n * Wait for document load before execute function.\n */\nexport function deferFunc(f) {\n\tif (document.readyState !== 'complete') window.addEventListener(\"load\", f, { once: true });\n\telse f();\n}\n\n/*\n * Formatting funciton using the given decimals and seperator.\n */\nexport function formatter(num, dec, sep) {\n\tlet res = L.Util.formatNum(num, dec).toString();\n\tlet numbers = res.split(\".\");\n\tif (numbers[1]) {\n\t\tfor (let d = dec - numbers[1].length; d > 0; d--) {\n\t\t\tnumbers[1] += \"0\";\n\t\t}\n\t\tres = numbers.join(sep || \".\");\n\t}\n\treturn res;\n}\n\n/**\n * Simple GeoJSON data loader.\n */\nexport function GeoJSONLoader(data, control) {\n\tif (typeof data === \"string\") {\n\t\tdata = JSON.parse(data);\n\t}\n\tcontrol = control || this;\n\n\tlet layer = L.geoJson(data, {\n\t\tstyle: (feature) => {\n\t\t\tlet style = L.extend({}, control.options.polyline);\n\t\t\tif (control.options.theme) {\n\t\t\t\tstyle.className += ' ' + control.options.theme;\n\t\t\t}\n\t\t\treturn style;\n\t\t},\n\t\tpointToLayer: (feature, latlng) => {\n\t\t\tlet marker = L.marker(latlng, { icon: control.options.gpxOptions.marker_options.wptIcons[''] });\n\t\t\tlet desc = feature.properties.desc ? feature.properties.desc : '';\n\t\t\tlet name = feature.properties.name ? feature.properties.name : '';\n\t\t\tif (name || desc) {\n\t\t\t\tmarker.bindPopup(\"<b>\" + name + \"</b>\" + (desc.length > 0 ? '<br>' + desc : '')).openPopup();\n\t\t\t}\n\t\t\tcontrol.fire('waypoint_added', { point: marker, point_type: 'waypoint', element: latlng });\n\t\t\treturn marker;\n\t\t},\n\t\tonEachFeature: (feature, layer) => {\n\t\t\tif (feature.geometry.type == 'Point') return;\n\n\t\t\tcontrol.addData(feature, layer);\n\n\t\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"geojson\", name: data.name });\n\t\t},\n\t});\n\n\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info }, true);\n\n\treturn layer;\n}\n\n/**\n * Simple GPX data loader.\n */\nexport function GPXLoader(data, control) {\n\tcontrol = control || this;\n\n\tcontrol.options.gpxOptions.polyline_options = L.extend({}, control.options.polyline, control.options.gpxOptions.polyline_options);\n\n\tif (control.options.theme) {\n\t\tcontrol.options.gpxOptions.polyline_options.className += ' ' + control.options.theme;\n\t}\n\n\tlet layer = new L.GPX(data, control.options.gpxOptions);\n\n\t// similar to L.GeoJSON.pointToLayer\n\tlayer.on('addpoint', (e) => {\n\t\tcontrol.fire(\"waypoint_added\", e, true);\n\t});\n\n\t// similar to L.GeoJSON.onEachFeature\n\tlayer.once(\"addline\", (e) => {\n\t\tcontrol.addData(e.line /*, layer*/ );\n\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"gpx\", name: layer.get_name() });\n\t});\n\n\t// unlike the L.GeoJSON, L.GPX parsing is async\n\tlayer.once('loaded', (e) => {\n\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info }, true);\n\t});\n\n\treturn layer;\n}\n\n/**\n * Check DOM element visibility.\n */\nexport function isDomVisible(elem) {\n\treturn !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);\n}\n\n/**\n * Check object type.\n */\nexport function isObject(item) {\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n/**\n * Check DOM element viewport visibility.\n */\nexport function isVisible(elem) {\n\tif (!elem) return false;\n\n\tlet styles = window.getComputedStyle(elem);\n\n\tfunction isVisibleByStyles(elem, styles) {\n\t\treturn styles.visibility !== 'hidden' && styles.display !== 'none';\n\t}\n\n\tfunction isAboveOtherElements(elem, styles) {\n\t\tlet boundingRect = elem.getBoundingClientRect();\n\t\tlet left = boundingRect.left + 1;\n\t\tlet right = boundingRect.right - 1;\n\t\tlet top = boundingRect.top + 1;\n\t\tlet bottom = boundingRect.bottom - 1;\n\t\tlet above = true;\n\n\t\tlet pointerEvents = elem.style.pointerEvents;\n\n\t\tif (styles['pointer-events'] == 'none') elem.style.pointerEvents = 'auto';\n\n\t\tif (document.elementFromPoint(left, top) !== elem) above = false;\n\t\tif (document.elementFromPoint(right, top) !== elem) above = false;\n\n\t\t// Only for completely visible elements\n\t\t// if (document.elementFromPoint(left, bottom) !== elem) above = false;\n\t\t// if (document.elementFromPoint(right, bottom) !== elem) above = false;\n\n\t\telem.style.pointerEvents = pointerEvents;\n\n\t\treturn above;\n\t}\n\n\tif (!isVisibleByStyles(elem, styles)) return false;\n\tif (!isAboveOtherElements(elem, styles)) return false;\n\treturn true;\n}\n\n/**\n * Check JSON object type.\n */\nexport function isJSONDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"{\") == 0 || doc.indexOf(\"[\") == 0;\n\t} else {\n\t\ttry {\n\t\t\tJSON.parse(doc.toString());\n\t\t} catch (e) {\n\t\t\tif (typeof doc === \"object\" && lazy) return true;\n\t\t\tconsole.warn(e);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\n/**\n * Check XML object type.\n */\nexport function isXMLDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"<\") == 0;\n\t} else {\n\t\tlet documentElement = (doc ? doc.ownerDocument || doc : 0).documentElement;\n\t\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n\t}\n}\n\n/**\n * Async JS script download.\n */\nexport function lazyLoader(url, skip, loader) {\n\tif (skip === false) {\n\t\treturn Promise.resolve();\n\t}\n\tif (loader instanceof Promise) {\n\t\treturn loader;\n\t}\n\treturn new Promise((resolve, reject) => {\n\t\tlet tag = document.createElement(\"script\");\n\t\ttag.addEventListener('load', resolve, { once: true });\n\t\ttag.src = url;\n\t\tdocument.head.appendChild(tag);\n\t});\n}\n\n/**\n * Download data from a remote url.\n */\nexport function loadFile(url, success) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet xhr = new XMLHttpRequest();\n\t\txhr.responseType = \"text\";\n\t\txhr.open('GET', url);\n\t\txhr.onload = () => resolve(xhr.response);\n\t\txhr.onerror = () => reject(\"Error \" + xhr.status + \" while fetching remote file: \" + url);\n\t\txhr.send();\n\t});\n}\n\n/**\n * Generate download data event.\n */\nexport function saveFile(dataURI, fileName) {\n\tlet a = create('a', '', { href: dataURI, target: '_new', download: fileName || \"\", style: \"display:none;\" });\n\tlet b = document.body;\n\tb.appendChild(a);\n\ta.click();\n\tb.removeChild(a);\n}\n\n/**\n * Wait for element visible before execute function.\n */\nexport function waitHolder(elem) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet ticking = false;\n\t\tlet scrollFn = () => {\n\t\t\tif (!ticking) {\n\t\t\t\tL.Util.requestAnimFrame(() => {\n\t\t\t\t\tif (isVisible(elem)) {\n\t\t\t\t\t\twindow.removeEventListener('scroll', scrollFn);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t\tticking = false;\n\t\t\t\t});\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('scroll', scrollFn);\n\t\tif (elem) elem.addEventListener('mouseenter', scrollFn, { once: true });\n\t\tscrollFn();\n\t});\n}\n\n/**\n * A little bit safier than L.DomUtil.addClass\n */\nexport function addClass(targetNode, className) {\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.addClass(targetNode, s); });\n}\n\n/**\n * A little bit safier than L.DomUtil.removeClass()\n */\nexport function removeClass(targetNode, className) {\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.removeClass(targetNode, s); });\n}\n\nexport function style(targetNode, name, value) {\n\tif (typeof value === \"undefined\") return L.DomUtil.getStyle(targetNode, name);\n\telse return targetNode.style.setProperty(name, value);\n}\n\n/**\n * A little bit shorter than L.DomUtil.create()\n */\nexport function create(tagName, className, attributes, parent) {\n\tlet elem = L.DomUtil.create(tagName, className || \"\");\n\tif (attributes) setAttributes(elem, attributes);\n\tif (parent) append(parent, elem);\n\treturn elem;\n}\n\n/**\n * Same as node.appendChild()\n */\nexport function append(parent, child) {\n\treturn parent.appendChild(child);\n}\n\n/**\n * Same as node.insertAdjacentElement()\n */\nexport function insert(parent, child, position) {\n\treturn parent.insertAdjacentElement(position, child);\n}\n\n/**\n * Loop for node.setAttribute()\n */\nexport function setAttributes(elem, attrs) {\n\tfor (let k in attrs) { elem.setAttribute(k, attrs[k]); }\n}\n\n/**\n * Same as node.querySelector().\n */\nexport function select(selector, context) {\n\treturn (context || document).querySelector(selector);\n}\n\n/**\n * Alias for L.DomEvent.on.\n */\nexport const on = L.DomEvent.on;\n\n/**\n * Alias for L.DomEvent.off.\n */\nexport const off = L.DomEvent.off;\n\n/**\n * Alias for L.DomUtil.hasClass.\n */\nexport const hasClass = L.DomUtil.hasClass;\n\n\nexport function randomId() {\n\treturn Math.random().toString(36).substr(2, 9);\n}\n\nexport function each(obj, fn) {\n\tfor (let i in obj) fn(obj[i]);\n}\n","export const Area = ({\n\tdata,\n\tname,\n\txAttr,\n\tyAttr,\n\tscaleX,\n\tscaleY,\n\theight,\n\tinterpolation = \"curveLinear\",\n}) => {\n\treturn path => {\n\t\tif (typeof interpolation === 'string') interpolation = d3[interpolation];\n\n\t\tlet area = d3.area().curve(interpolation)\n\t\t\t.x(d => (d.xDiagCoord = scaleX(d[xAttr])))\n\t\t\t.y0(height)\n\t\t\t.y1(d => scaleY(d[yAttr]));\n\n\t\tif (data) path.datum(data).attr(\"d\", area);\n\t\tif (name) path.attr('data-name', name);\n\n\t\treturn area;\n\t};\n};\n\nexport const AreaPath = (props) => {\n\treturn d3.create('svg:path')\n\t\t.attr(\"class\", \"area\")\n\t\t.call(Area(props));\n};\n\nexport const Axis = ({\n\ttype = \"axis\",\n\ttickSize = 6,\n\ttickPadding = 3,\n\tposition,\n\theight,\n\twidth,\n\taxis,\n\tscale,\n\tticks,\n\ttickFormat,\n\tlabel,\n\tlabelX,\n\tlabelY\n}) => {\n\treturn g => {\n\t\tlet [w, h] = [0, 0];\n\t\tif (position == \"bottom\") h = height;\n\t\tif (position == \"right\") w = width;\n\n\t\tif (axis == \"x\" && type == \"grid\") {\n\t\t\ttickSize = -height;\n\t\t} else if (axis == \"y\" && type == \"grid\") {\n\t\t\ttickSize = -width;\n\t\t}\n\n\t\tlet axisScale = d3[\"axis\" + position.replace(/\\b\\w/g, l => l.toUpperCase())]()\n\t\t\t.scale(scale)\n\t\t\t.ticks(ticks)\n\t\t\t.tickPadding(tickPadding)\n\t\t\t.tickSize(tickSize)\n\t\t\t.tickFormat(tickFormat);\n\n\t\tlet axisGroup = g.append(\"g\")\n\t\t\t.attr(\"class\", [axis, type, position].join(\" \"))\n\t\t\t.attr(\"transform\", \"translate(\" + w + \",\" + h + \")\")\n\t\t\t.call(axisScale);\n\n\t\tif (label) {\n\t\t\taxisGroup.append(\"text\")\n\t\t\t\t.attr(\"x\", labelX)\n\t\t\t\t.attr(\"y\", labelY)\n\t\t\t\t.text(label);\n\t\t}\n\n\t\treturn axisGroup;\n\t};\n};\n\nexport const DragRectangle = ({\n\tdragStartCoords,\n\tdragEndCoords,\n\theight,\n}) => {\n\treturn rect => {\n\t\tlet x1 = Math.min(dragStartCoords[0], dragEndCoords[0]);\n\t\tlet x2 = Math.max(dragStartCoords[0], dragEndCoords[0]);\n\n\t\treturn rect\n\t\t\t.attr(\"width\", x2 - x1)\n\t\t\t.attr(\"height\", height)\n\t\t\t.attr(\"x\", x1);\n\t};\n};\n\nexport const FocusRect = ({\n\twidth,\n\theight,\n}) => {\n\treturn rect => rect\n\t\t.attr(\"width\", width)\n\t\t.attr(\"height\", height)\n\t\t.style(\"fill\", \"none\")\n\t\t.style(\"stroke\", \"none\")\n\t\t.style(\"pointer-events\", \"all\");\n};\n\nexport const Grid = (props) => {\n\tprops.type = \"grid\";\n\treturn Axis(props);\n};\n\nexport const HeightFocusLine = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlength = 0,\n}) => {\n\treturn line => line\n\t\t.attr(\"class\", theme + \" height-focus line\")\n\t\t.attr(\"x1\", xCoord)\n\t\t.attr(\"x2\", xCoord)\n\t\t.attr(\"y1\", yCoord)\n\t\t.attr(\"y2\", length);\n};\n\nexport const HeightFocusLabel = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlabel,\n}) => {\n\treturn text => {\n\t\ttext\n\t\t\t.attr(\"class\", theme + \" height-focus-label\")\n\t\t\t.style(\"pointer-events\", \"none\")\n\t\t\t.attr(\"x\", xCoord + 5)\n\t\t\t.attr(\"y\", yCoord);\n\n\t\tlet y = text.select(\".height-focus-y\");\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\n\n\t\ty\n\t\t\t.attr(\"class\", \"height-focus-y\")\n\t\t\t.text(label);\n\n\t\ttext.selectAll('tspan').attr(\"x\", xCoord + 5);\n\n\t\treturn text;\n\t};\n};\n\nexport const HeightFocusPoint = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n}) => {\n\treturn circle => circle\n\t\t.attr(\"class\", theme + \" height-focus circle-lower\")\n\t\t.attr(\"transform\", \"translate(\" + xCoord + \",\" + yCoord + \")\")\n\t\t.attr(\"r\", 6)\n\t\t.attr(\"cx\", 0)\n\t\t.attr(\"cy\", 0);\n};\n\n\nexport const LegendItem = ({\n\tname,\n\twidth,\n\theight,\n\tmargins = {},\n}) => {\n\treturn g => {\n\t\tg\n\t\t\t.attr(\"class\", \"legend-item legend-\" + name.toLowerCase())\n\t\t\t.attr(\"data-name\", name);\n\n\t\tg.append(\"rect\")\n\t\t\t.attr(\"class\", \"area\")\n\t\t\t.attr(\"x\", (width / 2) - 50)\n\t\t\t.attr(\"y\", height + margins.bottom / 2)\n\t\t\t.attr(\"width\", 50)\n\t\t\t.attr(\"height\", 10)\n\t\t\t.attr(\"opacity\", 0.75);\n\n\t\tg.append('text')\n\t\t\t.text(L._(name))\n\t\t\t.attr(\"x\", (width / 2) + 5)\n\t\t\t.attr(\"font-size\", 10)\n\t\t\t.style(\"text-decoration-thickness\", \"2px\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr('y', height + margins.bottom / 2)\n\t\t\t.attr('dy', \"0.75em\");\n\n\t\treturn g;\n\t}\n};\n\nexport const MouseFocusLine = ({\n\txCoord = 0,\n\theight,\n}) => {\n\treturn line => line\n\t\t.attr('class', 'mouse-focus-line')\n\t\t.attr('x2', xCoord)\n\t\t.attr('y2', 0)\n\t\t.attr('x1', xCoord)\n\t\t.attr('y1', height);\n};\n\nexport const MouseFocusLabel = ({\n\txCoord,\n\tyCoord,\n\tlabelX = \"\",\n\tlabelY = \"\",\n\twidth,\n}) => {\n\treturn g => {\n\n\t\tg.attr('class', 'mouse-focus-label');\n\n\t\tlet rect = g.select(\".mouse-focus-label-rect\");\n\t\tlet text = g.select(\".mouse-focus-label-text\");\n\t\tlet y = text.select(\".mouse-focus-label-y\");\n\t\tlet x = text.select(\".mouse-focus-label-x\");\n\n\t\tif (!rect.node()) rect = g.append(\"rect\");\n\t\tif (!text.node()) text = g.append(\"svg:text\");\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\n\t\tif (!x.node()) x = text.append(\"svg:tspan\");\n\n\t\ty.text(labelY);\n\t\tx.text(labelX);\n\n\t\t// Sets focus-label-text position to the left / right of the mouse-focus-line\n\t\tlet xAlign = 0;\n\t\tlet yAlign = 0;\n\t\tlet bbox = { width: 0, height: 0 };\n\t\ttry { bbox = text.node().getBBox(); } catch (e) { return g; }\n\n\t\tif (xCoord) xAlign = xCoord + (xCoord < width / 2 ? 10 : -bbox.width - 10);\n\t\tif (yCoord) yAlign = Math.max(yCoord - bbox.height, L.Browser.webkit ? 0 : -Infinity);\n\n\t\trect\n\t\t\t.attr(\"class\", \"mouse-focus-label-rect\")\n\t\t\t.attr(\"x\", xAlign - 5)\n\t\t\t.attr(\"y\", yAlign - 5)\n\t\t\t.attr(\"width\", bbox.width + 10)\n\t\t\t.attr(\"height\", bbox.height + 10)\n\t\t\t.attr(\"rx\", 3)\n\t\t\t.attr(\"ry\", 3);\n\t\ttext\n\t\t\t.attr(\"class\", \"mouse-focus-label-text\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr(\"y\", yAlign);\n\t\ty\n\t\t\t.attr(\"class\", \"mouse-focus-label-y\")\n\t\t\t.attr(\"dy\", \"1em\");\n\t\tx\n\t\t\t.attr(\"class\", \"mouse-focus-label-x\")\n\t\t\t.attr(\"dy\", \"2em\");\n\n\t\ttext.selectAll('tspan').attr(\"x\", xAlign);\n\n\t\treturn g;\n\t};\n};\n\nexport const Scale = ({\n\tdata,\n\tattr,\n\tmin,\n\tforceBounds,\n\trange,\n}) => {\n\tlet domain = data ? d3.extent(data, d => d[attr]) : [0, 1];\n\tif (typeof min !== \"undefined\" && (min < domain[0] || forceBounds)) {\n\t\tdomain[0] = min;\n\t}\n\tif (typeof max !== \"undefined\" && (max > domain[1] || forceBounds)) {\n\t\tdomain[1] = max;\n\t}\n\treturn d3.scaleLinear()\n\t\t.range(range)\n\t\t.domain(domain);\n};\n\nexport const Bisect = ({\n\tdata = [0, 1],\n\tscale,\n\tx,\n\tattr\n}) => {\n\treturn d3\n\t\t.bisector(d => d[attr])\n\t\t.left(data, scale.invert(x));\n};\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\n\nexport var Chart = L.Class.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\tinitialize: function(options) {\n\t\tlet opts = this.options = options;\n\n\t\tthis._data = [];\n\t\tthis._draggingEnabled = opts.dragging;\n\n\t\tif (this.options.imperial) {\n\t\t\t// this._distanceFactor = this.__mileFactor;\n\t\t\t// this._heightFactor = this.__footFactor;\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\t// this._distanceFactor = this.options.distanceFactor;\n\t\t\t// this._heightFactor = this.options.heightFactor;\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tthis._xTicks = opts.xTicks;\n\t\tthis._yTicks = opts.yTicks;\n\n\t\tlet scale = this._updateScale();\n\n\t\tlet svg = this._svg = d3.create(\"svg\")\n\t\t\t.attr(\"class\", \"background\")\n\t\t\t.attr(\"width\", opts.width)\n\t\t\t.attr(\"height\", opts.height);\n\n\t\tlet g = svg\n\t\t\t.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + opts.margins.left + \",\" + opts.margins.top + \")\")\n\t\t\t.call(this._appendGrid())\n\t\t\t.call(this._appendAxis())\n\t\t\t.call(this._appendAreaPath())\n\t\t\t.call(this._appendFocusable())\n\t\t\t.call(this._appendLegend());\n\n\t\tthis._grid = svg.select('.grid');\n\t\tthis._area = svg.select('.area');\n\t\tthis._path = svg.select('.area path');\n\t\tthis._axis = svg.select('.axis');\n\t\tthis._focus = svg.select('.focus');\n\t\tthis._focusRect = this._focus.select('rect');\n\t\tthis._legend = svg.select('.legend');\n\t\tthis._x = scale.x;\n\t\tthis._y = scale.y;\n\n\t},\n\n\tupdate: function(props) {\n\t\tif (props.data) this._data = props.data;\n\t\tif (props.options) this.options = props.options;\n\n\t\tthis._updateScale();\n\t\tthis._updateAxis();\n\t\tthis._updateAreaPath();\n\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._svg.node());\n\t},\n\n\t_updateScale: function() {\n\t\tlet opts = this.options;\n\n\t\tthis._x = D3.Scale({\n\t\t\tdata: this._data,\n\t\t\trange: [0, this._width()],\n\t\t\tattr: opts.xAttr,\n\t\t\tmin: opts.xAxisMin,\n\t\t\tmax: opts.xAxisMax,\n\t\t\tforceBounds: opts.forceAxisBounds,\n\t\t});\n\n\t\tthis._y = D3.Scale({\n\t\t\tdata: this._data,\n\t\t\trange: [this._height(), 0],\n\t\t\tattr: opts.yAttr,\n\t\t\tmin: opts.yAxisMin,\n\t\t\tmax: opts.yAxisMax,\n\t\t\tforceBounds: opts.forceAxisBounds,\n\t\t});\n\n\t\treturn { x: this._x, y: this._y };\n\t},\n\n\t/**\n\t * Update chart axis.\n\t */\n\t_updateAxis: function() {\n\t\tthis._grid.selectAll('g').remove();\n\t\tthis._axis.selectAll('g').remove();\n\t\tthis._grid\n\t\t\t.call(this._appendXGrid())\n\t\t\t.call(this._appendYGrid());\n\t\tthis._axis\n\t\t\t.call(this._appendXaxis())\n\t\t\t.call(this._appendYaxis());\n\n\t\t// this.fire('axis_updated');\n\t},\n\n\t_updateAreaPath: function() {\n\t\tlet opts = this.options;\n\t\tthis._path\n\t\t\t.call(\n\t\t\t\tD3.Area({\n\t\t\t\t\tinterpolation: opts.interpolation,\n\t\t\t\t\tdata: this._data,\n\t\t\t\t\tname: 'Altitude',\n\t\t\t\t\txAttr: opts.xAttr,\n\t\t\t\t\tyAttr: opts.yAttr,\n\t\t\t\t\twidth: this._width(),\n\t\t\t\t\theight: this._height(),\n\t\t\t\t\tscaleX: this._x,\n\t\t\t\t\tscaleY: this._y,\n\t\t\t\t})\n\t\t\t);\n\t},\n\n\t/**\n\t * Generate \"grid\".\n\t */\n\t_appendGrid: function() {\n\t\treturn g =>\n\t\t\tg.append(\"g\")\n\t\t\t.attr(\"class\", \"grid\")\n\t\t\t.call(this._appendXGrid())\n\t\t\t.call(this._appendYGrid());\n\t},\n\n\t/**\n\t * Generate \"x-grid\".\n\t */\n\t_appendXGrid: function() {\n\t\treturn D3.Grid({\n\t\t\taxis: \"x\",\n\t\t\tposition: \"bottom\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._x,\n\t\t\tticks: this._xTicks,\n\t\t\ttickFormat: \"\",\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"y-grid\".\n\t */\n\t_appendYGrid: function() {\n\t\treturn D3.Grid({\n\t\t\taxis: \"y\",\n\t\t\tposition: \"left\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._y,\n\t\t\tticks: this.options.yTicks,\n\t\t\ttickFormat: \"\",\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"axis\".\n\t */\n\t_appendAxis: function() {\n\t\treturn g =>\n\t\t\tg.append(\"g\")\n\t\t\t.attr(\"class\", \"axis\")\n\t\t\t.call(this._appendXaxis())\n\t\t\t.call(this._appendYaxis());\n\t},\n\n\t/**\n\t * Generate \"x-axis\".\n\t */\n\t_appendXaxis: function() {\n\t\treturn D3.Axis({\n\t\t\taxis: \"x\",\n\t\t\tposition: \"bottom\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._x,\n\t\t\tticks: this._xTicks,\n\t\t\tlabel: this._xLabel,\n\t\t\tlabelY: 25,\n\t\t\tlabelX: this._width() + 6,\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"y-axis\".\n\t */\n\t_appendYaxis: function() {\n\t\treturn D3.Axis({\n\t\t\taxis: \"y\",\n\t\t\tposition: \"left\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._y,\n\t\t\tticks: this.options.yTicks,\n\t\t\tlabel: this._yLabel,\n\t\t\tlabelX: -25,\n\t\t\tlabelY: 3,\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"path\".\n\t */\n\t_appendAreaPath: function() {\n\t\treturn g => g.append('g')\n\t\t\t.attr(\"class\", \"area\")\n\t\t\t.append('path');\n\t},\n\n\t_appendFocusable: function() {\n\t\treturn g => {\n\t\t\treturn g.append('g')\n\t\t\t\t.attr(\"class\", 'focus')\n\t\t\t\t.call(this._appendFocusRect())\n\t\t\t\t.call(this._appendMouseFocusG());\n\t\t};\n\t},\n\n\t/**\n\t * Generate \"mouse-focus\" and \"drag-rect\".\n\t */\n\t_appendFocusRect: function() {\n\t\treturn g => {\n\t\t\tlet focusRect = g.append(\"rect\")\n\t\t\t\t.call(\n\t\t\t\t\tD3.FocusRect({\n\t\t\t\t\t\twidth: this._width(),\n\t\t\t\t\t\theight: this._height()\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tif (L.Browser.mobile) {\n\t\t\t\tfocusRect\n\t\t\t\t\t.on(\"touchstart.drag\", this._dragStartHandler.bind(this))\n\t\t\t\t\t.on(\"touchmove.drag\", this._dragHandler.bind(this))\n\t\t\t\t\t.on(\"touchstart.focus\", this._mousemoveHandler.bind(this))\n\t\t\t\t\t.on(\"touchmove.focus\", this._mousemoveHandler.bind(this));\n\t\t\t\tL.DomEvent.on(this._svg.node(), 'touchend', this._dragEndHandler, this);\n\t\t\t}\n\n\t\t\tfocusRect\n\t\t\t\t.on(\"mousedown.drag\", this._dragStartHandler.bind(this))\n\t\t\t\t.on(\"mousemove.drag\", this._dragHandler.bind(this))\n\t\t\t\t.on(\"mouseenter.focus\", this._mouseenterHandler.bind(this))\n\t\t\t\t.on(\"mousemove.focus\", this._mousemoveHandler.bind(this))\n\t\t\t\t.on(\"mouseout.focus\", this._mouseoutHandler.bind(this));\n\t\t\tL.DomEvent.on(this._svg.node(), 'mouseup', this._dragEndHandler, this);\n\n\t\t\treturn focusRect;\n\t\t};\n\t},\n\n\t/**\n\t * Generate \"mouse-focus\".\n\t */\n\t_appendMouseFocusG: function() {\n\t\treturn g => {\n\t\t\tlet focusG = this._focusG = g.append(\"g\")\n\t\t\t\t.attr(\"class\", \"mouse-focus-group hidden\");\n\n\t\t\tthis._focusline = focusG.append('svg:line')\n\t\t\t\t.call(\n\t\t\t\t\tD3.MouseFocusLine({\n\t\t\t\t\t\txCoord: 0,\n\t\t\t\t\t\theight: this._height()\n\t\t\t\t\t})\n\t\t\t\t);;\n\t\t\tthis._focuslabel = focusG.append(\"g\")\n\t\t\t\t.call(\n\t\t\t\t\tD3.MouseFocusLabel({\n\t\t\t\t\t\txCoord: 0,\n\t\t\t\t\t\tyCoord: 0,\n\t\t\t\t\t\theight: this._height(),\n\t\t\t\t\t\twidth: this._width(),\n\t\t\t\t\t\tlabelX: \"\",\n\t\t\t\t\t\tlabelY: \"\",\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\treturn focusG;\n\t\t};\n\t},\n\n\t/**\n\t * Generate \"legend\".\n\t */\n\t_appendLegend: function() {\n\t\treturn g => {\n\t\t\t// if (!this.options.legend) return;\n\n\t\t\tlet legend = g.append('g')\n\t\t\t\t.attr(\"class\", \"legend\");\n\n\t\t\t// this.fire(\"legend\");\n\n\t\t\t// let items = legend.selectAll('.legend-item')\n\t\t\t// \t.on('click', (d, i) => {\n\t\t\t// \t\tlet target = items.nodes()[i];\n\t\t\t// \t\tlet name = target.getAttribute('data-name');\n\t\t\t// \t\tlet path = this._area.select('path[data-name=\"' + name + '\"]').node();\n\t\t\t// \t\t// this._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\n\t\t\t// \t});\n\n\t\t\treturn legend;\n\t\t};\n\t},\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t/*\n\t * Handle drag operations.\n\t */\n\t_dragHandler: function() {\n\t\t//we don't want map events to occur here\n\t\td3.event.preventDefault();\n\t\td3.event.stopPropagation();\n\n\t\tthis._gotDragged = true;\n\t\tthis._drawDragRectangle();\n\t},\n\n\t/*\n\t * Handles start of drag operations.\n\t */\n\t_dragStartHandler: function() {\n\t\td3.event.preventDefault();\n\t\td3.event.stopPropagation();\n\n\t\tthis._gotDragged = false;\n\t\tthis._dragStartCoords = d3.mouse(this._focusRect.node());\n\t},\n\n\t/*\n\t * Draws the currently dragged rectangle over the chart.\n\t */\n\t_drawDragRectangle: function() {\n\t\tif (!this._dragStartCoords || !this._draggingEnabled) return;\n\t\tif (!this._dragRectangle) {\n\t\t\tthis._dragRectangle = this._focus.insert(\"rect\", \".mouse-focus-group\")\n\t\t\t\t.attr('class', 'mouse-drag')\n\t\t\t\t.style(\"pointer-events\", \"none\");\n\t\t}\n\t\tthis._dragRectangle.call(\n\t\t\tD3.DragRectangle({\n\t\t\t\tdragStartCoords: this._dragStartCoords,\n\t\t\t\tdragEndCoords: this._dragCurrentCoords = d3.mouse(this._focusRect.node()),\n\t\t\t\theight: this._height(),\n\t\t\t})\n\t\t);\n\t},\n\n\t/*\n\t * Handles end of drag operations. Zooms the map to the selected items extent.\n\t */\n\t_dragEndHandler: function() {\n\t\tif (!this._dragStartCoords || !this._dragCurrentCoords || !this._gotDragged) {\n\t\t\tthis._dragStartCoords = null;\n\t\t\tthis._gotDragged = false;\n\t\t\tif (this._draggingEnabled) this._resetDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tlet start = this._findItemForX(this._dragStartCoords[0]);\n\t\tlet end = this._findItemForX(this._dragCurrentCoords[0]);\n\n\t\tif (start == end) return;\n\n\t\tthis._dragStartCoords = null;\n\t\tthis._gotDragged = false;\n\n\t\tthis.fire('dragged', { dragstart: this._data[start], dragend: this._data[end] });\n\t},\n\n\t/*\n\t * Handles the moueseenter over the chart.\n\t */\n\t_mouseenterHandler: function() {\n\t\tthis.fire(\"mouse_enter\");\n\t},\n\n\t/*\n\t * Handles the moueseover the chart and displays distance and altitude level.\n\t */\n\t_mousemoveHandler: function(d, i, ctx) {\n\t\tlet coords = d3.mouse(this._focusRect.node());\n\t\tlet xCoord = coords[0];\n\t\tlet item = this._data[this._findItemForX(xCoord)];\n\n\t\tthis.fire(\"mouse_move\", { item: item, xCoord: xCoord });\n\t},\n\n\t/*\n\t * Handles the moueseout over the chart.\n\t */\n\t_mouseoutHandler: function() {\n\t\tthis.fire(\"mouse_out\");\n\t},\n\n\t/*\n\t * Finds a data entry for a given x-coordinate of the diagram\n\t */\n\t_findItemForX: function(x) {\n\t\treturn d3\n\t\t\t.bisector(d => d[this.options.xAttr])\n\t\t\t.left(this._data || [0, 1], this._x.invert(x));\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tif (this._dragRectangle) {\n\t\t\tthis._dragRectangle.remove();\n\t\t\tthis._dragRectangle = null;\n\t\t\tthis._hideDiagramIndicator();\n\t\t\tthis.fire('reset_drag');\n\t\t}\n\t},\n\n\t/**\n\t * Display distance and altitude level (\"focus-rect\").\n\t */\n\t_showDiagramIndicator: function(item, xCoordinate) {\n\t\t// if (!this._chartEnabled) return;\n\n\t\tthis._focusG.classed(\"hidden\", false);\n\n\t\tlet opts = this.options;\n\t\tlet formatter = opts.hoverNumber.formatter;\n\t\tlet [fx, fy] = [opts.hoverNumber.decimalsX, opts.hoverNumber.decimalsY];\n\t\tlet yCoordinate = this._y(item[opts.yAttr]);\n\n\t\tthis._focusline.call(\n\t\t\tD3.MouseFocusLine({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\theight: this._height()\n\t\t\t})\n\t\t);\n\t\tthis._focuslabel.call(\n\t\t\tD3.MouseFocusLabel({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\tyCoord: yCoordinate,\n\t\t\t\theight: this._height(),\n\t\t\t\twidth: this._width(),\n\t\t\t\tlabelX: formatter(item[opts.xAttr], fx) + \" \" + this._xLabel,\n\t\t\t\tlabelY: formatter(item[opts.yAttr], fy) + \" \" + this._yLabel,\n\t\t\t})\n\t\t);\n\t},\n\n\t_hideDiagramIndicator: function() {\n\t\tthis._focusG.classed(\"hidden\", true);\n\t},\n});\n\nChart.addInitHook(function() {\n\tthis.on('mouse_move', function(e) {\n\t\tif (e.item) this._showDiagramIndicator(e.item, e.xCoord);\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\n\nexport var Marker = L.Class.extend({\n\n\tinitialize: function(options) {\n\t\tthis.options = options;\n\n\t\tif (this.options.imperial) {\n\t\t\t// this._distanceFactor = this.__mileFactor;\n\t\t\t// this._heightFactor = this.__footFactor;\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\t// this._distanceFactor = this.options.distanceFactor;\n\t\t\t// this._heightFactor = this.options.heightFactor;\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tlet g = this._heightG = d3.create(\"g\").attr(\"class\", \"height-focus-group\");\n\t\t\tthis._mouseHeightFocus = d3.create('svg:line');\n\t\t\tthis._pointG = d3.create(\"svg:circle\");\n\t\t\tthis._mouseHeightFocusLabel = d3.create(\"svg:text\");\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\tthis._marker = L.marker([0, 0], { icon: this.options.markerIcon, zIndexOffset: 1000000, interactive: false });\n\t\t}\n\t},\n\n\taddTo: function(map) {\n\t\tthis._map = map;\n\t\tlet pane, renderer;\n\t\tif (!map.getPane('elevationPane')) {\n\t\t\tpane = this._pane = map.createPane('elevationPane');\n\t\t\tpane.style.zIndex = 625; // This pane is above markers but below popups.\n\t\t\tpane.style.pointerEvents = 'none';\n\t\t}\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\trenderer = L.svg({ pane: \"elevationPane\" }).addTo(this._map); // default leaflet svg renderer\n\t\t\tlet g = this._heightG = d3.select(renderer.getPane()).select(\"svg > g\").attr(\"class\", \"height-focus-group\");\n\t\t\tg.append(() => this._mouseHeightFocus.node());\n\t\t\tg.append(() => this._pointG.node());\n\t\t\tg.append(() => this._mouseHeightFocusLabel.node());\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\tthis._marker.addTo(map, { pane: 'elevationPane' });\n\t\t}\n\t},\n\n\t/**\n\t * Update position marker (\"leaflet-marker\").\n\t */\n\tupdate: function(props) {\n\t\tif (props.options) this.options = props.options;\n\n\t\tlet opts = this.options;\n\n\t\tif (!this._map) this.addTo(props.map);\n\n\t\tthis._latlng = props.item.latlng;\n\n\t\tlet point = L.extend({}, props.item, this._map.latLngToLayerPoint(this._latlng));\n\n\t\tif (this.options.marker == 'elevation-line') {\n\n\t\t\tlet formatter = opts.hoverNumber.formatter;\n\t\t\tlet fy = opts.hoverNumber.decimalsY;\n\n\t\t\tlet normalizedAlt = this._height() / props.maxElevation * point.z;\n\t\t\tlet normalizedY = point.y - normalizedAlt;\n\n\t\t\tthis._heightG.classed(\"hidden\", false);\n\t\t\tthis._pointG.classed(\"hidden\", false);\n\n\t\t\tthis._pointG\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusPoint({\n\t\t\t\t\t\ttheme: this.options.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t}));\n\n\t\t\tthis._mouseHeightFocus\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLine({\n\t\t\t\t\t\ttheme: this.options.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t\tlength: normalizedY\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tthis._mouseHeightFocusLabel\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLabel({\n\t\t\t\t\t\ttheme: this.options.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: normalizedY,\n\t\t\t\t\t\tlabel: formatter(point[opts.yAttr], fy) + \" \" + this._yLabel\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.removeClass(this._marker.getElement(), 'hidden');\n\t\t\tthis._marker.setLatLng(this._latlng);\n\t\t}\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\tremove: function() {\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tif (this._heightG) this._heightG.classed(\"hidden\", true);\n\t\t\tif (this._pointG) this._pointG.classed(\"hidden\", true);\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.addClass(this._marker.getElement(), 'hidden');\n\t\t}\n\t},\n\n\tgetLatLng: function() {\n\t\treturn this._latlng;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n});","export var Summary = L.Class.extend({\n\n});\n","import * as _ from './utils';\n\nexport var Options = {\n\tautohide: !L.Browser.mobile,\n\tautohideMarker: true,\n\tcollapsed: false,\n\tdetached: true,\n\tdistanceFactor: 1,\n\tdragging: !L.Browser.mobile,\n\tdownloadLink: 'link',\n\televationDiv: \"#elevation-div\",\n\tfollowMarker: true,\n\tforceAxisBounds: false,\n\tgpxOptions: {\n\t\tasync: true,\n\t\tmarker_options: {\n\t\t\tstartIconUrl: null,\n\t\t\tendIconUrl: null,\n\t\t\tshadowUrl: null,\n\t\t\twptIcons: {\n\t\t\t\t'': L.divIcon({\n\t\t\t\t\tclassName: 'elevation-waypoint-marker',\n\t\t\t\t\thtml: '<i class=\"elevation-waypoint-icon\"></i>',\n\t\t\t\t\ticonSize: [30, 30],\n\t\t\t\t\ticonAnchor: [8, 30],\n\t\t\t\t})\n\t\t\t},\n\t\t},\n\t},\n\theight: 200,\n\theightFactor: 1,\n\thoverNumber: {\n\t\tdecimalsX: 2,\n\t\tdecimalsY: 0,\n\t\tformatter: _.formatter,\n\t},\n\timperial: false,\n\tinterpolation: \"curveLinear\",\n\tlazyLoadJS: true,\n\tlegend: true,\n\tloadData: {\n\t\tdefer: false,\n\t\tlazy: false,\n\t},\n\tmarker: 'elevation-line',\n\tmarkerIcon: L.divIcon({\n\t\tclassName: 'elevation-position-marker',\n\t\thtml: '<i class=\"elevation-position-icon\"></i>',\n\t\ticonSize: [32, 32],\n\t\ticonAnchor: [16, 16],\n\t}),\n\tplaceholder: false,\n\tposition: \"topright\",\n\tpolyline: {\n\t\tclassName: 'elevation-polyline',\n\t\tcolor: '#000',\n\t\topacity: 0.75,\n\t\tweight: 5,\n\t\tlineCap: 'round'\n\t},\n\treverseCoords: false,\n\tskipNullZCoords: false,\n\ttheme: \"lightblue-theme\",\n\tmargins: {\n\t\ttop: 10,\n\t\tright: 20,\n\t\tbottom: 30,\n\t\tleft: 50\n\t},\n\tresponsive: true,\n\tsummary: 'inline',\n\tslope: false,\n\twidth: 600,\n\txAttr: \"dist\",\n\txLabel: \"km\",\n\txTicks: undefined,\n\tyAttr: \"z\",\n\tyAxisMax: undefined,\n\tyAxisMin: undefined,\n\tyLabel: \"m\",\n\tyTicks: undefined,\n\tzFollow: 13,\n};\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Chart } from './chart';\nimport { Marker } from './marker';\nimport { Summary } from './summary';\nimport { Options } from './options';\n\nexport const Elevation = L.Control.Elevation = L.Control.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\toptions: Options,\n\t__mileFactor: 0.621371,\n\t__footFactor: 3.28084,\n\t__D3: 'https://unpkg.com/d3@5.15.0/dist/d3.min.js',\n\t__LGPX: 'https://unpkg.com/leaflet-gpx@1.5.0/gpx.js',\n\n\t/*\n\t * Add data to the diagram either from GPX or GeoJSON and update the axis domain and data\n\t */\n\taddData: function(d, layer) {\n\t\tif ((typeof layer === \"undefined\" || layer === null) && d.on) {\n\t\t\tlayer = d;\n\t\t}\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._addData(d);\n\t\t\tthis._addLayer(layer);\n\t\t\tthis._fireEvt(\"eledata_added\", { data: d, layer: layer, track_info: this.track_info });\n\t\t});\n\t},\n\n\t/**\n\t * Adds the control to the given map.\n\t */\n\taddTo: function(map) {\n\t\tif (this.options.detached) {\n\t\t\tlet eleDiv = this._initElevationDiv();\n\t\t\tif (!eleDiv.isConnected) _.insert(map._container, eleDiv, 'afterend');\n\t\t\t_.append(eleDiv, this.onAdd(map));\n\t\t} else {\n\t\t\tL.Control.prototype.addTo.call(this, map);\n\t\t}\n\t\treturn this;\n\t},\n\n\t/*\n\t * Reset data and display\n\t */\n\tclear: function() {\n\t\tthis._clearPath();\n\t\tthis._clearChart();\n\t\tthis._clearData();\n\n\t\tthis._fireEvt(\"eledata_clear\");\n\t},\n\n\t/**\n\t * Disable dragging chart on touch events.\n\t */\n\tdisableDragging: function() {\n\t\tthis._chart._draggingEnabled = false;\n\t\tthis._resetDrag();\n\t},\n\n\t/**\n\t * Enable dragging chart on touch events.\n\t */\n\tenableDragging: function() {\n\t\tthis._chart._draggingEnabled = true;\n\t},\n\n\t/**\n\t * Sets a map view that contains the given geographical bounds.\n\t */\n\tfitBounds: function(bounds) {\n\t\tbounds = bounds || this.getBounds();\n\t\tif (this._map && bounds.isValid()) this._map.fitBounds(bounds);\n\t},\n\n\tgetBounds: function(data) {\n\t\tdata = data || this._data;\n\t\treturn L.latLngBounds(data.map((d) => d.latlng));\n\t},\n\n\t/**\n\t * Get default zoom level when \"followMarker\" is true.\n\t */\n\tgetZFollow: function() {\n\t\treturn this._zFollow;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\thide: function() {\n\t\t_.style(this._container, \"display\", \"none\");\n\t},\n\n\t/**\n\t * Initialize chart control \"options\" and \"container\".\n\t */\n\tinitialize: function(options) {\n\t\tthis.options = _.deepMerge({}, this.options, options);\n\n\t\tif (this.options.imperial) {\n\t\t\tthis._distanceFactor = this.__mileFactor;\n\t\t\tthis._heightFactor = this.__footFactor;\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\tthis._distanceFactor = this.options.distanceFactor;\n\t\t\tthis._heightFactor = this.options.heightFactor;\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tthis._chartEnabled = true;\n\t\tthis._zFollow = this.options.zFollow;\n\n\t\tif (this.options.followMarker) this._setMapView = L.Util.throttle(this._setMapView, 300, this);\n\t\tif (this.options.placeholder) this.options.loadData.lazy = this.options.loadData.defer = true;\n\n\t\tif (this.options.legend) this.options.margins.bottom += 30;\n\t},\n\n\t/**\n\t * Alias for loadData\n\t */\n\tload: function(data, opts) {\n\t\tthis.loadData(data, opts);\n\t},\n\n\t/**\n\t * Alias for addTo\n\t */\n\tloadChart: function(map) {\n\t\tthis.addTo(map);\n\t},\n\n\t/**\n\t * Load elevation data (GPX or GeoJSON).\n\t */\n\tloadData: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\tif (opts.defer) {\n\t\t\tthis.loadDefer(data, opts);\n\t\t} else if (opts.lazy) {\n\t\t\tthis.loadLazy(data, opts);\n\t\t} else if (_.isXMLDoc(data)) {\n\t\t\tthis.loadGPX(data);\n\t\t} else if (_.isJSONDoc(data)) {\n\t\t\tthis.loadGeoJSON(data);\n\t\t} else {\n\t\t\tthis.loadFile(data);\n\t\t}\n\t},\n\n\t/**\n\t * Wait for document load before download data.\n\t */\n\tloadDefer: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\topts.defer = false;\n\t\t_.deferFunc(L.bind(this.loadData, this, data, opts));\n\t},\n\n\t/**\n\t * Load data from a remote url.\n\t */\n\tloadFile: function(url) {\n\t\t_.loadFile(url)\n\t\t\t.then((data) => {\n\t\t\t\tthis._downloadURL = url; // TODO: handle multiple urls?\n\t\t\t\tthis.loadData(data, { lazy: false, defer: false });\n\t\t\t})\n\t\t\t.catch((err) => console.warn(err));\n\t},\n\n\t/**\n\t * Load raw GeoJSON data.\n\t */\n\tloadGeoJSON: function(data) {\n\t\t_.GeoJSONLoader(data, this);\n\t},\n\n\t/**\n\t * Load raw GPX data.\n\t */\n\tloadGPX: function(data) {\n\t\tElevation._gpxLazyLoader = _.lazyLoader(\n\t\t\tthis.__LGPX,\n\t\t\ttypeof L.GPX !== 'function' || !this.options.lazyLoadJS,\n\t\t\tElevation._gpxLazyLoader\n\t\t).then(() => _.GPXLoader(data, this));\n\t},\n\n\t/**\n\t * Wait for chart container visible before download data.\n\t */\n\tloadLazy: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\tlet elem = opts.lazy.parentNode ? opts.lazy : this.placeholder;\n\t\t_.waitHolder(opts.lazy)\n\t\t\t.then(() => {\n\t\t\t\topts.lazy = false;\n\t\t\t\tthis.loadData(data, opts)\n\t\t\t\tthis.once('eledata_loaded', () => opts.lazy.parentNode.removeChild(elem));\n\t\t\t});\n\t},\n\n\t/**\n\t * Create container DOM element and related event listeners.\n\t * Called on control.addTo(map).\n\t */\n\tonAdd: function(map) {\n\t\tthis._map = map;\n\n\t\tlet container = this._container = _.create(\"div\", \"elevation-control elevation \" + this.options.theme);\n\n\t\tif (!this.options.detached) {\n\t\t\t_.addClass(container, 'leaflet-control');\n\t\t}\n\n\t\tif (this.options.placeholder && !this._data) {\n\t\t\tthis.placeholder = _.create('img', 'elevation-placeholder', typeof this.options.placeholder === 'string' ? { src: this.options.placeholder, alt: '' } : this.options.placeholder);\n\t\t\t_.insert(container, this.placeholder, 'beforebegin');\n\t\t}\n\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._initToggle(container);\n\t\t\tthis._initChart(container);\n\t\t\tthis._initMarker(container);\n\n\t\t\tthis._map.on('zoom viewreset zoomanim', this._hidePositionMarker, this);\n\t\t\tthis._map.on('resize', this._resetView, this);\n\t\t\tthis._map.on('resize', this._resizeChart, this);\n\t\t\tthis._map.on('mousedown', this._resetDrag, this);\n\n\t\t\t_.on(this._map._container, 'mousewheel', this._resetDrag, this);\n\t\t\t_.on(this._map._container, 'touchstart', this._resetDrag, this);\n\n\t\t\tthis.on('eledata_added', this._updateChart, this);\n\t\t\tthis.on('eledata_added', this._updateSummary, this);\n\n\t\t\tthis._updateChart();\n\t\t\tthis._updateSummary();\n\t\t});\n\n\t\treturn container;\n\t},\n\n\t/**\n\t * Clean up control code and related event listeners.\n\t * Called on control.remove().\n\t */\n\tonRemove: function(map) {\n\t\tthis._container = null;\n\n\t\tthis._map.off('zoom viewreset zoomanim', this._hidePositionMarker, this);\n\t\tthis._map.off('resize', this._resetView, this);\n\t\tthis._map.off('resize', this._resizeChart, this);\n\t\tthis._map.off('mousedown', this._resetDrag, this);\n\n\t\t_.off(this._map._container, 'mousewheel', this._resetDrag, this);\n\t\t_.off(this._map._container, 'touchstart', this._resetDrag, this);\n\n\t\tthis.off('eledata_added', this._updateChart, this);\n\t\tthis.off('eledata_added', this._updateSummary, this);\n\t},\n\n\t/**\n\t * Redraws the chart control. Sometimes useful after screen resize.\n\t */\n\tredraw: function() {\n\t\tthis._resizeChart();\n\t},\n\n\t/**\n\t * Set default zoom level when \"followMarker\" is true.\n\t */\n\tsetZFollow: function(zoom) {\n\t\tthis._zFollow = zoom;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\tshow: function() {\n\t\t_.style(this._container, \"display\", \"block\");\n\t},\n\n\t/*\n\t * Parsing data either from GPX or GeoJSON and update the diagram data\n\t */\n\t_addData: function(d) {\n\t\tlet geom = d && d.geometry;\n\t\tlet feat = d && d.type === \"FeatureCollection\";\n\t\tlet gpx = d && d._latlngs;\n\n\t\tif (geom) {\n\t\t\tswitch (geom.type) {\n\t\t\t\tcase 'LineString':\n\t\t\t\t\tthis._addGeoJSONData(geom.coordinates);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'MultiLineString':\n\t\t\t\t\t_.each(geom.coordinates, coords => this._addGeoJSONData(coords));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn('Unsopperted GeoJSON feature geometry type:' + geom.type);\n\t\t\t}\n\t\t}\n\n\t\tif (feat) {\n\t\t\t_.each(d.features, feature => this._addData(feature));\n\t\t}\n\n\t\tif (gpx) {\n\t\t\tthis._addGPXData(d._latlngs);\n\t\t}\n\t},\n\n\t/*\n\t * Parsing of GeoJSON data lines and their elevation in z-coordinate\n\t */\n\t_addGeoJSONData: function(coords) {\n\t\t_.each(coords, point => this._addPoint(point[1], point[0], point[2]));\n\t},\n\n\t/*\n\t * Parsing function for GPX data and their elevation in z-coordinate\n\t */\n\t_addGPXData: function(coords) {\n\t\t_.each(coords, point => this._addPoint(point.lat, point.lng, point.meta.ele));\n\t},\n\n\t/*\n\t * Parse and push a single (x, y, z) point to current elevation profile.\n\t */\n\t_addPoint: function(x, y, z) {\n\t\tif (this.options.reverseCoords) {\n\t\t\t[x, y] = [y, x];\n\t\t}\n\n\t\tlet data = this._data || [];\n\t\tlet eleMax = this._maxElevation || -Infinity;\n\t\tlet eleMin = this._minElevation || +Infinity;\n\t\tlet dist = this._distance || 0;\n\n\t\tlet curr = new L.LatLng(x, y);\n\t\tlet prev = data.length ? data[data.length - 1].latlng : curr;\n\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\n\n\t\tdist = dist + Math.round(delta / 1000 * 100000) / 100000;\n\n\t\t// check and fix missing elevation data on last added point\n\t\tif (!this.options.skipNullZCoords && data.length > 0) {\n\t\t\tlet prevZ = data[data.length - 1].z;\n\t\t\tif (isNaN(prevZ)) {\n\t\t\t\tlet lastZ = this._lastValidZ;\n\t\t\t\tlet currZ = z * this._heightFactor;\n\t\t\t\tif (!isNaN(lastZ) && !isNaN(currZ)) {\n\t\t\t\t\tprevZ = (lastZ + currZ) / 2;\n\t\t\t\t} else if (!isNaN(lastZ)) {\n\t\t\t\t\tprevZ = lastZ;\n\t\t\t\t} else if (!isNaN(currZ)) {\n\t\t\t\t\tprevZ = currZ;\n\t\t\t\t}\n\t\t\t\tif (!isNaN(prevZ)) data[data.length - 1].z = prevZ;\n\t\t\t\telse data.splice(data.length - 1, 1);\n\t\t\t}\n\t\t}\n\n\t\tz = z * this._heightFactor;\n\n\t\t// skip point if it has not elevation\n\t\tif (!isNaN(z)) {\n\t\t\teleMax = eleMax < z ? z : eleMax;\n\t\t\teleMin = eleMin > z ? z : eleMin;\n\t\t\tthis._lastValidZ = z;\n\t\t}\n\n\t\tdata.push({\n\t\t\tdist: dist,\n\t\t\tx: x,\n\t\t\ty: y,\n\t\t\tz: z,\n\t\t\tlatlng: curr\n\t\t});\n\n\t\tthis._data = data;\n\t\tthis.track_info = this.track_info || {};\n\t\tthis.track_info.distance = this._distance = dist;\n\t\tthis.track_info.elevation_max = this._maxElevation = eleMax;\n\t\tthis.track_info.elevation_min = this._minElevation = eleMin;\n\n\t\tthis._fireEvt(\"eledata_updated\", { index: data.length - 1 });\n\t},\n\n\t_addLayer: function(layer) {\n\t\tif (layer) {\n\t\t\t_.addClass(layer._path, this.options.polyline.className + ' ' + this.options.theme);\n\n\t\t\tlayer\n\t\t\t\t.on(\"mousemove\", this._mousemoveLayerHandler, this)\n\t\t\t\t.on(\"mouseout\", this._mouseoutHandler, this);\n\n\t\t\tthis._layers = this._layers || {};\n\t\t\tthis._layers[L.Util.stamp(layer)] = layer;\n\t\t}\n\t},\n\n\t/**\n\t * Adds the control to the given \"detached\" div.\n\t */\n\t_initElevationDiv: function() {\n\t\tlet eleDiv = _.select(this.options.elevationDiv);\n\t\tif (!eleDiv) {\n\t\t\tthis.options.elevationDiv = '#elevation-div_' + _.randomId();\n\t\t\teleDiv = _.create('div', 'leaflet-control elevation elevation-div', { id: this.options.elevationDiv.substr(1) });\n\t\t}\n\t\tif (this.options.detached) {\n\t\t\t_.addClass(eleDiv, 'elevation-detached');\n\t\t\t_.removeClass(eleDiv, 'leaflet-control');\n\t\t}\n\t\tthis.eleDiv = eleDiv;\n\t\treturn this.eleDiv;\n\t},\n\n\t/**\n\t * Generate \"div\" summary container.\n\t */\n\t_appendSummary: function() {\n\t\treturn container => {\n\t\t\tlet summary = this.summaryDiv = container.append(\"div\")\n\t\t\t\t.attr(\"class\", \"elevation-summary \" + (this.options.summary ? this.options.summary + \"-summary\" : '')).node();\n\t\t\t// let summary = this.summaryDiv = _.create('div', \"elevation-summary \" + (this.options.summary ? this.options.summary + \"-summary\" : ''), container);\n\n\t\t\t_.style(this.summaryDiv, 'max-width', this.options.width + \"px\");\n\n\t\t\tthis._updateSummary();\n\t\t\treturn summary;\n\t\t};\n\t},\n\n\t/*\n\t * Reset chart.\n\t */\n\t_clearChart: function() {\n\t\tthis._resetDrag();\n\t},\n\n\t/*\n\t * Reset data.\n\t */\n\t_clearData: function() {\n\t\tthis._data = null;\n\t\tthis._distance = null;\n\t\tthis._maxElevation = null;\n\t\tthis._minElevation = null;\n\t\tthis.track_info = null;\n\t\tthis._layers = null;\n\t},\n\n\t/*\n\t * Reset path.\n\t */\n\t_clearPath: function() {\n\t\tthis._hidePositionMarker();\n\t\t_.each(this._layers, l => _.removeClass(l._path, this.options.polyline.className + ' ' + this.options.theme));\n\t},\n\n\t/*\n\t * Collapse current chart control.\n\t */\n\t_collapse: function() {\n\t\t_.removeClass(this._container, 'elevation-expanded');\n\t\t_.addClass(this._container, 'elevation-collapsed');\n\t},\n\n\t/*\n\t * Expand current chart control.\n\t */\n\t_expand: function() {\n\t\t_.removeClass(this._container, 'elevation-collapsed');\n\t\t_.addClass(this._container, 'elevation-expanded');\n\t},\n\n\t/*\n\t * Finds an item with the smallest delta in distance to the given latlng coords\n\t */\n\t_findItemForLatLng: function(latlng) {\n\t\tlet result = null;\n\t\tlet d = Infinity;\n\t\t_.each(this._data,\n\t\t\titem => {\n\t\t\t\tlet dist = latlng.distanceTo(item.latlng);\n\t\t\t\tif (dist < d) {\n\t\t\t\t\td = dist;\n\t\t\t\t\tresult = item;\n\t\t\t\t}\n\t\t\t});\n\t\treturn result;\n\t},\n\n\t/*\n\t * Finds a data entry for a given x-coordinate of the diagram\n\t */\n\t_findItemForX: function(x) {\n\t\treturn this._chart._findItemForX(x);\n\t},\n\n\t/**\n\t * Fires an event of the specified type.\n\t */\n\t_fireEvt: function(type, data, propagate) {\n\t\tif (this.fire) this.fire(type, data, propagate);\n\t\tif (this._map) this._map.fire(type, data, propagate);\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\t_hidePositionMarker: function() {\n\t\tif (this.options.autohideMarker) {\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Generate \"svg\" chart DOM element.\n\t */\n\t_initChart: function() {\n\t\tlet opts = this.options;\n\t\topts.xTicks = opts.xTicks || Math.round(this._width() / 75);\n\t\topts.yTicks = opts.yTicks || Math.round(this._height() / 30);\n\n\t\tif (opts.responsive) {\n\t\t\tif (opts.detached) {\n\t\t\t\tlet offWi = this.eleDiv.offsetWidth;\n\t\t\t\tlet offHe = this.eleDiv.offsetHeight;\n\t\t\t\topts.width = offWi > 0 ? offWi : opts.width;\n\t\t\t\topts.height = (offHe - 20) > 0 ? offHe - 20 : opts.height; // 20 = horizontal scrollbar size.\n\t\t\t} else {\n\t\t\t\topts._maxWidth = opts._maxWidth > opts.width ? opts._maxWidth : opts.width;\n\t\t\t\tlet containerWidth = this._map._container.clientWidth;\n\t\t\t\topts.width = opts._maxWidth > containerWidth ? containerWidth - 30 : opts.width;\n\t\t\t}\n\t\t}\n\n\t\tlet chart = this._chart = new Chart(opts);\n\n\t\tlet container = d3.select(this._container)\n\t\t\t.call(this._chart.render())\n\t\t\t.call(this._appendSummary());\n\n\t\tthis._svg = chart._svg;\n\t\tthis._grid = chart._grid;\n\t\tthis._area = chart._area;\n\t\tthis._path = chart._path;\n\t\tthis._axis = chart._axis;\n\t\tthis._focus = chart._focus;\n\t\tthis._focusRect = chart._focusRect;\n\t\tthis._x = chart._x;\n\t\tthis._y = chart._y;\n\t\tthis._legend = chart._legend;\n\t\tthis._focuslabel = this._chart._focuslabel;\n\t\tthis._focusline = this._chart._focusline;\n\n\t\tchart.on('reset_drag', this._hidePositionMarker, this);\n\t\tchart.on('mouse_enter', this._fireEvt.bind('elechart_enter'), this);\n\t\tchart.on('dragged', this._fireEvt.bind(\"elechart_dragged\"), this);\n\t\tchart.on('mouse_move', this._mousemoveHandler, this);\n\t\tchart.on('mouse_out', this._mouseoutHandler, this);\n\t\t// chart.on('legend', this._fireEvt.bind('elechart_legend'), this);\n\n\t\tthis._fireEvt(\"elechart_init\");\n\t},\n\n\t_initMarker: function(container) {\n\t\tthis._marker = new Marker(this.options);\n\t},\n\n\t/**\n\t * Inspired by L.Control.Layers\n\t */\n\t_initToggle: function(container) {\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\n\t\tcontainer.setAttribute('aria-haspopup', true);\n\n\t\tif (!this.options.detached) {\n\t\t\tL.DomEvent\n\t\t\t\t.disableClickPropagation(container);\n\t\t\t//.disableScrollPropagation(container);\n\t\t}\n\n\t\tif (L.Browser.mobile) {\n\t\t\t_.on(container, 'click', L.DomEvent.stopPropagation);\n\t\t}\n\n\t\t_.on(container, 'mousewheel', this._mousewheelHandler, this);\n\n\t\tif (!this.options.detached) {\n\t\t\tlet link = this._button = _.create('a', \"elevation-toggle elevation-toggle-icon\" + (this.options.autohide ? \"\" : \" close-button\"), { href: '#', title: L._('Elevation') }, container);\n\n\t\t\tif (this.options.collapsed) {\n\t\t\t\tthis._collapse();\n\t\t\t\tif (this.options.autohide) {\n\t\t\t\t\t_.on(container, 'mouseover', this._expand, this);\n\t\t\t\t\t_.on(container, 'mouseout', this._collapse, this);\n\t\t\t\t} else {\n\t\t\t\t\t_.on(link, 'click', L.DomEvent.stop);\n\t\t\t\t\t_.on(link, 'click', this._toggle, this);\n\t\t\t\t}\n\n\t\t\t\t_.on(link, 'focus', this._toggle, this);\n\n\t\t\t\tthis._map.on('click', this._collapse, this);\n\t\t\t\t// TODO: keyboard accessibility\n\t\t\t}\n\t\t} else {\n\t\t\t// TODO: handle autohide when detached=true\n\t\t}\n\t},\n\n\t/*\n\t * Handles the moueseover the chart and displays distance and altitude level.\n\t */\n\t_mousemoveHandler: function(e) {\n\t\tif (!this._data || this._data.length === 0 || !this._chartEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tlet xCoord = e.xCoord;\n\t\tlet item = this._data[this._findItemForX(xCoord)];\n\n\t\tthis._showPositionMarker(item);\n\t\tthis._setMapView(item);\n\n\t\tif (this._map) {\n\t\t\t_.addClass(this._map._container, 'elechart-hover');\n\t\t}\n\n\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\tthis._fireEvt(\"elechart_hover\", { data: item, xCoord: xCoord });\n\t},\n\n\t/*\n\t * Handles mouseover events of the data layers on the map.\n\t */\n\t_mousemoveLayerHandler: function(e) {\n\t\tif (!this._data || this._data.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet item = this._findItemForLatLng(e.latlng);\n\t\tif (item) {\n\t\t\tlet xCoord = item.xDiagCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._showPositionMarker(item);\n\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles the moueseout over the chart.\n\t */\n\t_mouseoutHandler: function() {\n\t\tif (!this.options.detached) {\n\t\t\tthis._hidePositionMarker();\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t}\n\n\t\tif (this._map) {\n\t\t\t_.removeClass(this._map._container, 'elechart-hover');\n\t\t}\n\n\t\tthis._fireEvt(\"elechart_leave\");\n\t},\n\n\t/*\n\t * Handles the mouesewheel over the chart.\n\t */\n\t_mousewheelHandler: function(e) {\n\t\tif (this._map.gestureHandling && this._map.gestureHandling._enabled) return;\n\t\tlet ll = this._marker.getLatLng() || this._map.getCenter();\n\t\tlet z = this._map.getZoom() + Math.sign(e.deltaY);\n\t\tthis._resetDrag();\n\t\tthis._map.flyTo(ll, z);\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tthis._chart._resetDrag();\n\t\tthis._hidePositionMarker();\n\t},\n\n\t/**\n\t * Resets drag, marker and bounds.\n\t */\n\t_resetView: function() {\n\t\tif (this._map && this._map._isFullscreen) return;\n\t\tthis._resetDrag();\n\t\tthis._hidePositionMarker();\n\t\tthis.fitBounds();\n\t},\n\n\t/**\n\t * Hacky way for handling chart resize. Deletes it and redraw chart.\n\t */\n\t_resizeChart: function() {\n\t\t// prevent displaying chart on resize if hidden\n\t\tif (_.style(this._container, \"display\") == \"none\") return;\n\n\t\tif (this.options.responsive) {\n\t\t\tif (this.options.detached) {\n\t\t\t\tlet newWidth = this.eleDiv.offsetWidth; // - 20;\n\t\t\t\tif (newWidth) {\n\t\t\t\t\tthis.options.width = newWidth;\n\t\t\t\t\tthis.eleDiv.innerHTML = \"\";\n\t\t\t\t\t_.append(this.eleDiv, this.onAdd(this._map));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._map.removeControl(this._container);\n\t\t\t\tthis.addTo(this._map);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Collapse or Expand current chart control.\n\t */\n\t_toggle: function() {\n\t\tif (_.hasClass(this._container, \"elevation-expanded\"))\n\t\t\tthis._collapse();\n\t\telse\n\t\t\tthis._expand();\n\t},\n\n\t/**\n\t * Sets the view of the map (center and zoom). Useful when \"followMarker\" is true.\n\t */\n\t_setMapView: function(item) {\n\t\tif (!this.options.followMarker || !this._map) return;\n\t\tlet zoom = this._map.getZoom();\n\t\tzoom = zoom < this._zFollow ? this._zFollow : zoom;\n\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\n\t},\n\n\t/*\n\t * Shows the position/height indicator marker drawn onto the map\n\t */\n\t_showPositionMarker: function(item) {\n\t\tif (this.options.marker) {\n\t\t\tthis._marker.update({ item: item, map: this._map, maxElevation: this._maxElevation, options: this.options });\n\t\t\tthis._mouseHeightFocusLabel = this._marker._mouseHeightFocusLabel;\n\t\t}\n\t},\n\n\t/**\n\t * Calculates [x, y] domain and then update chart.\n\t */\n\t_updateChart: function() {\n\t\tif (!this._data || !this._container) return;\n\n\t\tthis._chart = this._chart.update({ data: this._data });\n\n\t\tthis._x = this._chart._x;\n\t\tthis._y = this._chart._y;\n\n\t\tthis._fireEvt(\"elechart_axis\");\n\t\tif (this.options.legend) this._fireEvt(\"elechart_legend\");\n\n\t\tthis._fireEvt('elechart_updated');\n\t},\n\n\t/**\n\t * Update chart summary.\n\t */\n\t_updateSummary: function() {\n\t\tthis.summaryDiv.innerHTML = '';\n\t\tthis.track_info = this.track_info || {};\n\t\tthis.track_info.distance = this._distance || 0;\n\t\tthis.track_info.elevation_max = this._maxElevation || 0;\n\t\tthis.track_info.elevation_min = this._minElevation || 0;\n\n\t\tif (this.options.summary) {\n\t\t\tthis._fireEvt(\"elechart_summary\");\n\t\t}\n\t\tif (this.options.downloadLink && this._downloadURL) { // TODO: generate dynamically file content instead of using static file urls.\n\t\t\tthis.summaryDiv.innerHTML += '<span class=\"download\"><a href=\"#\">' + L._('Download') + '</a></span>'\n\t\t\t_.select('.download a', this.summaryDiv).onclick = (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis._fireEvt('eletrack_download', { downloadLink: this.options.downloadLink, confirm: _.saveFile.bind(this, this._downloadURL) });\n\t\t\t};\n\t\t};\n\t},\n\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\n\t},\n\n});\n\n/**\n * Attach here some useful elevation hooks.\n */\nElevation.addInitHook(function() {\n\n\tthis.on('waypoint_added', function(e) {\n\t\tlet p = e.point,\n\t\t\tpop = p._popup;\n\t\tif (pop) {\n\t\t\tpop.options.className = 'elevation-popup';\n\t\t}\n\t\tif (pop._content) {\n\t\t\tpop._content = decodeURI(pop._content);\n\t\t\tp.bindTooltip(pop._content, { direction: 'top', sticky: true, opacity: 1, className: 'elevation-tooltip' }).openTooltip();\n\t\t}\n\t});\n\n\tthis.on('elepath_toggle', function(e) {\n\t\tlet path = e.path;\n\n\t\tlet enabled = _.hasClass(path, 'hidden');\n\t\tlet text = _.select('text', e.legend);\n\n\t\tif (enabled) {\n\t\t\t_.removeClass(path, 'hidden');\n\t\t\t_.style(text, \"text-decoration-line\", \"\")\n\t\t} else {\n\t\t\t_.addClass(path, 'hidden');\n\t\t\t_.style(text, \"text-decoration-line\", \"line-through\")\n\t\t}\n\n\t\tthis._chartEnabled = this._area.selectAll('path:not(.hidden)').nodes().length != 0;\n\n\t\t// autotoggle chart data on single click\n\t\tif (!this._chartEnabled) {;\n\t\t\tthis._resetDrag();\n\t\t\tthis._clearPath();\n\t\t} else {\n\t\t\t// this._resizeChart();\n\t\t\t_.each(this._layers, l => _.addClass(l._path, this.options.polyline.className + ' ' + this.options.theme));\n\t\t}\n\t});\n\n\tthis.on(\"elechart_dragged\", function(e) {\n\t\tthis._hidePositionMarker();\n\t\tthis.fitBounds(L.latLngBounds([e.dragstart.latlng, e.dragend.latlng]));\n\t});\n\n\tthis.on(\"elechart_legend\", function() {\n\t\tthis._altitudeLegend = this._legend.append('g')\n\t\t\t.call(\n\t\t\t\tD3.LegendItem({\n\t\t\t\t\tname: 'Altitude',\n\t\t\t\t\twidth: this._width(),\n\t\t\t\t\theight: this._height(),\n\t\t\t\t\tmargins: this.options.margins,\n\t\t\t\t})\n\t\t\t);\n\t});\n\n\tthis.on(\"elechart_updated\", function() {\n\t\t// TODO: maybe should i listen for this inside chart.js?\n\t\tthis._legend.selectAll('.legend-item')\n\t\t\t.on('click', (d, i, n) => {\n\t\t\t\tlet target = n[i];\n\t\t\t\tlet name = target.getAttribute('data-name');\n\t\t\t\tlet path = this._area.select('path[data-name=\"' + name + '\"]').node();\n\t\t\t\tthis._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\n\t\t\t});\n\t});\n\n\n\tthis.on(\"elechart_summary\", function() {\n\t\tthis.summaryDiv.innerHTML +=\n\t\t\t'<span class=\"totlen\"><span class=\"summarylabel\">' + L._(\"Total Length: \") + '</span><span class=\"summaryvalue\">' + this.track_info.distance.toFixed(2) + '&nbsp;' + this._xLabel + '</span></span>' +\n\t\t\t'<span class=\"maxele\"><span class=\"summarylabel\">' + L._(\"Max Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_max.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>' +\n\t\t\t'<span class=\"minele\"><span class=\"summarylabel\">' + L._(\"Min Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_min.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>';\n\t});\n\n\tthis.on(\"eletrack_download\", function(e) {\n\t\tif (e.downloadLink == 'modal' && typeof CustomEvent === \"function\") {\n\t\t\tdocument.dispatchEvent(new CustomEvent(\"eletrack_download\", { detail: e }));\n\t\t} else if (e.downloadLink == 'link' || e.downloadLink === true) {\n\t\t\te.confirm();\n\t\t}\n\t});\n\n\tthis.on('eledata_loaded', function(e) {\n\t\tlet layer = e.layer;\n\t\tif (this._map) {\n\t\t\tthis._map.once('layeradd', function(e) {\n\t\t\t\tthis.fitBounds(layer.getBounds());\n\t\t\t}, this);\n\t\t\tlayer.addTo(this._map);\n\t\t} else {\n\t\t\tconsole.warn(\"Undefined elevation map object\");\n\t\t}\n\t});\n\n\tthis.on('eledata_clear', function() {\n\t\tthis._area.selectAll('path')\n\t\t\t.attr(\"d\", \"M0 0\");\n\t\tif (this._path) {\n\t\t\t// this._x.domain([0, 1]);\n\t\t\t// this._y.domain([0, 1]);\n\t\t\t// this._updateAxis();\n\t\t}\n\t});\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.slope) return;\n\n\tlet opts = this.options;\n\tlet slope = {};\n\topts.margins.right = 50;\n\n\tif (this.options.slope != \"summary\") {\n\n\t\tthis.on(\"elechart_init\", function() {\n\t\t\tslope.path = this._area.append('path')\n\t\t\t\t.style(\"pointer-events\", \"none\")\n\t\t\t\t// TODO: add a class here.\n\t\t\t\t.attr(\"fill\", \"#F00\")\n\t\t\t\t.attr(\"stroke\", \"#000\")\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\n\t\t});\n\n\t\tthis.on(\"elechart_axis\", function() {\n\t\t\tslope.x = this._x;\n\n\t\t\t// slope.x = D3.Scale({\n\t\t\t// \tdata: this._data,\n\t\t\t// \trange: [0, this._width()],\n\t\t\t// \tattr: opts.xAttr,\n\t\t\t// \tmin: opts.xAxisMin,\n\t\t\t// \tmax: opts.xAxisMax,\n\t\t\t// \tforceBounds: opts.forceAxisBounds,\n\t\t\t// });\n\n\t\t\tslope.y = D3.Scale({\n\t\t\t\tdata: this._data,\n\t\t\t\trange: [this._height(), 0],\n\t\t\t\tattr: \"slope\",\n\t\t\t\tmin: -1,\n\t\t\t\tmax: +1,\n\t\t\t\tforceBounds: opts.forceAxisBounds,\n\t\t\t});\n\n\t\t\tslope.axis = D3.Axis({\n\t\t\t\taxis: \"y\",\n\t\t\t\tposition: \"right\",\n\t\t\t\twidth: this._width(),\n\t\t\t\theight: this._height(),\n\t\t\t\tscale: slope.y,\n\t\t\t\tticks: this.options.yTicks,\n\t\t\t\ttickPadding: 16,\n\t\t\t\tlabel: \"%\",\n\t\t\t\tlabelX: 25,\n\t\t\t\tlabelY: 3,\n\t\t\t});\n\n\t\t\tthis._axis.call(slope.axis);\n\t\t});\n\n\t\tthis.on(\"elechart_updated\", function() {\n\t\t\tslope.area = D3.Area({\n\t\t\t\tinterpolation: \"curveStepAfter\",\n\t\t\t\tdata: this._data,\n\t\t\t\tname: 'Slope',\n\t\t\t\txAttr: opts.xAttr,\n\t\t\t\tyAttr: \"slope\",\n\t\t\t\twidth: this._width(),\n\t\t\t\theight: this._height(),\n\t\t\t\tscaleX: slope.x,\n\t\t\t\tscaleY: slope.y,\n\t\t\t});\n\n\t\t\tslope.path.call(slope.area);\n\t\t});\n\n\t\tthis.on(\"elechart_legend\", function() {\n\t\t\tslope.legend = this._legend.append(\"g\")\n\t\t\t\t.call(\n\t\t\t\t\tD3.LegendItem({\n\t\t\t\t\t\tname: 'Slope',\n\t\t\t\t\t\twidth: this._width(),\n\t\t\t\t\t\theight: this._height(),\n\t\t\t\t\t\tmargins: this.options.margins,\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tthis._altitudeLegend\n\t\t\t\t.attr(\"transform\", \"translate(-50, 0)\");\n\n\t\t\tslope.legend\n\t\t\t\t.attr(\"transform\", \"translate(50, 0)\");\n\n\t\t\tslope.legend.select(\"rect\")\n\t\t\t\t.classed(\"area\", false)\n\t\t\t\t// TODO: add a class here.\n\t\t\t\t.attr(\"fill\", \"#F00\")\n\t\t\t\t.attr(\"stroke\", \"#000\")\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\n\n\t\t});\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data = this._data;\n\t\tlet i = e.index;\n\t\tlet z = data[i].z;\n\n\t\tlet curr = data[i].latlng;\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\n\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\n\n\t\t// Slope / Gain\n\t\tlet tAsc = this._tAsc || 0; // Total Ascent\n\t\tlet tDes = this._tDes || 0; // Total Descent\n\t\tlet sMax = this._sMax || 0; // Slope Max\n\t\tlet sMin = this._sMin || 0; // Slope Min\n\t\tlet diff = 0;\n\t\tlet slope = 0;\n\n\t\tif (!isNaN(z)) {\n\t\t\t// diff height between actual and previous point\n\t\t\tdiff = i > 0 ? z - data[i - 1].z : 0;\n\t\t\tif (diff > 0) tAsc += diff;\n\t\t\tif (diff < 0) tDes -= diff;\n\t\t\t// slope in % = ( height / length ) * 100\n\t\t\tslope = delta !== 0 ? Math.round((diff / delta) * 10000) / 100 : 0;\n\t\t\t// apply slope to the previous point because we will\n\t\t\t// ascent or desent, so the slope is in the fist point\n\t\t\tif (i > 0) data[i - 1].slope = slope;\n\t\t\tsMax = slope > sMax ? slope : sMax;\n\t\t\tsMin = slope < sMin ? slope : sMin;\n\t\t}\n\n\t\tdata[i].slope = slope;\n\n\t\tthis.track_info = this.track_info || {};\n\t\tthis.track_info.ascent = this._tAsc = tAsc;\n\t\tthis.track_info.descent = this._tDes = tDes;\n\t\tthis.track_info.slope_max = this._sMax = sMax;\n\t\tthis.track_info.slope_min = this._sMin = sMin;\n\t});\n\n\tthis.on(\"elechart_change\", function(e) {\n\t\tlet item = e.data;\n\t\tlet xCoordinate = e.xCoord;\n\n\t\tif (this._focuslabel) {\n\t\t\tif (!this._focuslabelSlope || !this._focuslabelSlope.property('isConnected')) {\n\t\t\t\tthis._focuslabelSlope = this._focuslabel.select('text').insert(\"svg:tspan\", \".mouse-focus-label-x\")\n\t\t\t\t\t.attr(\"class\", \"mouse-focus-label-slope\")\n\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t}\n\n\t\t\tthis._focuslabelSlope.text(item.slope + \"%\");\n\n\t\t\tthis._focuslabel.select('.mouse-focus-label-x')\n\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t}\n\n\t\tif (this._mouseHeightFocusLabel) {\n\t\t\tif (!this._mouseSlopeFocusLabel) {\n\t\t\t\tthis._mouseSlopeFocusLabel = this._mouseHeightFocusLabel.append(\"svg:tspan\")\n\t\t\t\t\t.attr(\"class\", \"height-focus-slope \");\n\t\t\t}\n\n\t\t\tthis._mouseSlopeFocusLabel\n\t\t\t\t.attr(\"dy\", \"1.5em\")\n\t\t\t\t.text(Math.round(item.slope) + \"%\");\n\n\t\t\tthis._mouseHeightFocusLabel.select('.height-focus-y')\n\t\t\t\t.attr(\"dy\", \"-1.5em\");\n\t\t}\n\t});\n\n\tthis.on(\"elechart_summary\", function() {\n\t\tthis.track_info.ascent = this._tAsc || 0;\n\t\tthis.track_info.descent = this._tDes || 0;\n\t\tthis.track_info.slope_max = this._sMax || 0;\n\t\tthis.track_info.slope_min = this._sMin || 0;\n\n\t\tthis.summaryDiv.querySelector('.minele').insertAdjacentHTML('afterend', '<span class=\"ascent\"><span class=\"summarylabel\">' + L._(\"Total Ascent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.ascent) + '&nbsp;' +\n\t\t\tthis._yLabel +\n\t\t\t'</span></span>' + '<span class=\"descent\"><span class=\"summarylabel\">' + L._(\"Total Descent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.descent) + '&nbsp;' + this._yLabel +\n\t\t\t'</span></span>' + '<span class=\"minslope\"><span class=\"summarylabel\">' + L._(\"Min Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_min + '&nbsp;' + '%' +\n\t\t\t'</span></span>' + '<span class=\"maxslope\"><span class=\"summarylabel\">' + L._(\"Max Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_max + '&nbsp;' + '%' +\n\t\t\t'</span></span>');\n\t});\n\n\tthis.on(\"eledata_clear\", function() {\n\t\tthis._sMax = null;\n\t\tthis._sMin = null;\n\t\tthis._tAsc = null;\n\t\tthis._tDes = null;\n\t});\n\n});\n","/*\n * Copyright (c) 2019, GPL-3.0+ Project, Raruto\n *\n *  This file is free software: you may copy, redistribute and/or modify it\n *  under the terms of the GNU General Public License as published by the\n *  Free Software Foundation, either version 2 of the License, or (at your\n *  option) any later version.\n *\n *  This file is distributed in the hope that it will be useful, but\n *  WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see .\n *\n * This file incorporates work covered by the following copyright and\n * permission notice:\n *\n *     Copyright (c) 2013-2016, MIT License, Felix MrMufflon Bache\n *\n *     Permission to use, copy, modify, and/or distribute this software\n *     for any purpose with or without fee is hereby granted, provided\n *     that the above copyright notice and this permission notice appear\n *     in all copies.\n *\n *     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\n *     WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\n *     WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\n *     AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\n *     CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n *     OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\n *     NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\n *     CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Chart } from './chart';\nimport { Elevation } from './control';\nimport './slope';\n\nElevation.Utils = _;\nElevation.Components = D3;\nElevation.Chart = Chart;\n\nL.control.elevation = (options) => new Elevation(options);\n"],"names":["factory","window","define","amd","exports","module","require","L","locales","locale","registerLocale","code","Util","extend","setLocale","i18n","_","translate","string","data","template","err","deepMerge","target","sources","length","source","shift","isObject","key","Object","assign","deferFunc","f","document","readyState","addEventListener","once","formatter","num","dec","sep","res","formatNum","toString","numbers","split","d","join","GeoJSONLoader","control","JSON","parse","layer","geoJson","style","feature","options","polyline","theme","className","pointToLayer","latlng","marker","icon","gpxOptions","marker_options","wptIcons","desc","properties","name","bindPopup","openPopup","fire","point","point_type","element","onEachFeature","geometry","type","addData","track_info","_fireEvt","GPXLoader","polyline_options","GPX","on","e","line","get_name","isDomVisible","elem","offsetWidth","offsetHeight","getClientRects","item","Array","isArray","isVisible","styles","getComputedStyle","isVisibleByStyles","visibility","display","isAboveOtherElements","boundingRect","getBoundingClientRect","left","right","top","bottom","above","pointerEvents","elementFromPoint","isJSONDoc","doc","lazy","trim","indexOf","console","warn","isXMLDoc","documentElement","ownerDocument","nodeName","lazyLoader","url","skip","loader","Promise","resolve","reject","tag","createElement","src","head","appendChild","loadFile","success","xhr","XMLHttpRequest","responseType","open","onload","response","onerror","status","send","saveFile","dataURI","fileName","a","create","href","download","b","body","click","removeChild","waitHolder","ticking","scrollFn","requestAnimFrame","removeEventListener","addClass","targetNode","each","s","DomUtil","removeClass","value","getStyle","setProperty","tagName","attributes","parent","setAttributes","append","child","insert","position","insertAdjacentElement","attrs","k","setAttribute","select","selector","context","querySelector","DomEvent","off","hasClass","randomId","Math","random","substr","obj","fn","i","Area","xAttr","yAttr","scaleX","scaleY","height","interpolation","path","d3","area","curve","x","xDiagCoord","y0","y1","datum","attr","AreaPath","props","call","Axis","tickSize","tickPadding","width","axis","scale","ticks","tickFormat","label","labelX","labelY","g","w","h","axisScale","replace","l","toUpperCase","axisGroup","text","DragRectangle","dragStartCoords","dragEndCoords","rect","x1","min","x2","max","FocusRect","Grid","HeightFocusLine","xCoord","yCoord","HeightFocusLabel","y","node","selectAll","HeightFocusPoint","circle","LegendItem","margins","toLowerCase","MouseFocusLine","MouseFocusLabel","xAlign","yAlign","bbox","getBBox","Browser","webkit","Infinity","Scale","forceBounds","range","domain","extent","scaleLinear","Bisect","bisector","invert","Chart","Class","includes","Evented","prototype","Mixin","Events","initialize","opts","_data","_draggingEnabled","dragging","imperial","_xLabel","_yLabel","xLabel","yLabel","_xTicks","xTicks","_yTicks","yTicks","_updateScale","svg","_svg","_appendGrid","_appendAxis","_appendAreaPath","_appendFocusable","_appendLegend","_grid","_area","_path","_axis","_focus","_focusRect","_legend","_x","_y","update","_updateAxis","_updateAreaPath","render","container","D3","_width","xAxisMin","xAxisMax","forceAxisBounds","_height","yAxisMin","yAxisMax","remove","_appendXGrid","_appendYGrid","_appendXaxis","_appendYaxis","_appendFocusRect","_appendMouseFocusG","focusRect","mobile","_dragStartHandler","bind","_dragHandler","_mousemoveHandler","_dragEndHandler","_mouseenterHandler","_mouseoutHandler","focusG","_focusG","_focusline","_focuslabel","legend","event","preventDefault","stopPropagation","_gotDragged","_drawDragRectangle","_dragStartCoords","mouse","_dragRectangle","_dragCurrentCoords","_resetDrag","start","_findItemForX","end","dragstart","dragend","ctx","coords","_hideDiagramIndicator","_showDiagramIndicator","xCoordinate","classed","hoverNumber","decimalsX","decimalsY","fx","fy","yCoordinate","addInitHook","Marker","_heightG","_mouseHeightFocus","_pointG","_mouseHeightFocusLabel","_marker","markerIcon","zIndexOffset","interactive","addTo","map","_map","pane","renderer","getPane","_pane","createPane","zIndex","_latlng","latLngToLayerPoint","normalizedAlt","maxElevation","z","normalizedY","getElement","setLatLng","getLatLng","Summary","Options","autohide","autohideMarker","collapsed","detached","distanceFactor","downloadLink","elevationDiv","followMarker","async","startIconUrl","endIconUrl","shadowUrl","divIcon","html","iconSize","iconAnchor","heightFactor","lazyLoadJS","loadData","defer","placeholder","color","opacity","weight","lineCap","reverseCoords","skipNullZCoords","responsive","summary","slope","undefined","zFollow","Elevation","Control","__mileFactor","__footFactor","__D3","__LGPX","_d3LazyLoader","then","_addData","_addLayer","eleDiv","_initElevationDiv","isConnected","_container","onAdd","clear","_clearPath","_clearChart","_clearData","disableDragging","_chart","enableDragging","fitBounds","bounds","getBounds","isValid","latLngBounds","getZFollow","_zFollow","hide","_distanceFactor","_heightFactor","_chartEnabled","_setMapView","throttle","load","loadChart","loadDefer","loadLazy","loadGPX","loadGeoJSON","_downloadURL","catch","_gpxLazyLoader","parentNode","alt","_initToggle","_initChart","_initMarker","_hidePositionMarker","_resetView","_resizeChart","_updateChart","_updateSummary","onRemove","redraw","setZFollow","zoom","show","geom","feat","gpx","_latlngs","_addGeoJSONData","coordinates","features","_addGPXData","_addPoint","lat","lng","meta","ele","eleMax","_maxElevation","eleMin","_minElevation","dist","_distance","curr","LatLng","prev","delta","distanceTo","round","prevZ","isNaN","lastZ","_lastValidZ","currZ","splice","push","distance","elevation_max","elevation_min","index","_mousemoveLayerHandler","_layers","stamp","id","_appendSummary","summaryDiv","_collapse","_expand","_findItemForLatLng","result","propagate","offWi","offHe","_maxWidth","containerWidth","clientWidth","chart","disableClickPropagation","_mousewheelHandler","link","_button","title","stop","_toggle","_showPositionMarker","gestureHandling","_enabled","ll","getCenter","getZoom","sign","deltaY","flyTo","_isFullscreen","newWidth","innerHTML","removeControl","setView","animate","duration","onclick","confirm","p","pop","_popup","_content","decodeURI","bindTooltip","direction","sticky","openTooltip","enabled","nodes","_altitudeLegend","n","getAttribute","toFixed","CustomEvent","dispatchEvent","detail","tAsc","_tAsc","tDes","_tDes","sMax","_sMax","sMin","_sMin","diff","ascent","descent","slope_max","slope_min","_focuslabelSlope","property","_mouseSlopeFocusLabel","insertAdjacentHTML","Utils","Components","elevation"],"mappings":"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"}